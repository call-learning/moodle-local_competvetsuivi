define(["jquery","core/config","local_competvetsuivi/config","d3","d3-bullet-cvs","d3-progress"],function(a,b,c,d,e,f){return{default_padding:{top:10,right:5,bottom:1,left:5},bullet_charts:function(b,c){this.load_css("/local/competvetsuivi/js/d3-libraries/bullet-cvs/d3-bullet-cvs.css");var f="#"+b,g=a(f).first(),h=Object.assign(c.padding||{},this.default_padding),i=g.parent().width()-h.left-h.right,j=g.parent().height()-h.top-h.bottom,k=e.bulletcvs().width(i).height(j).data(c);d.select(f).call(k)},progress_charts:function(b,c){this.load_css("/local/competvetsuivi/js/d3-libraries/progress/d3-progress.css");var e=this;a(document).ready(function(){var g="#"+b,h=a(g).first(),i=Object.assign(c.padding||{},e.default_padding),j=h.width()-i.left-i.right,k=h.height()-i.top-i.bottom,l=f.progress().width(j).height(k).data(c);d.select(g).call(l)})},ring_charts:function(b,c){var e=this;a(document).ready(function(){e.add_patterns_definitions();var f="#"+b,g=a(f).first(),h=e.default_padding,i=g.parent().width()-h.left-h.right,j=g.parent().height()-h.top-h.bottom,k=Math.min(i,j)/2.2,l=d.arc().outerRadius(k-10).innerRadius(k/1.3),m=d.arc().outerRadius(k).innerRadius(k-10),n=d.select(f).attr("width",i).attr("height",j).append("g").attr("transform","translate("+(i/2+h.left)+","+(j/2+h.top)+")"),o=d.pie().value(function(a){return a.val}),p=o(Object.values(c.compsvalues)),q=n.selectAll(".arc").data(p).enter().append("g").attr("class","arc");q.append("path").attr("d",l).attr("class",function(a){return"macrocomp-"+a.data.colorindex+" arc-bg"});var r=function(a){var b=a.endAngle-a.startAngle,d=Object.assign({},a),e="undefined"!==a.data.strandvals[c.overlaystrandid]?a.data.strandvals[c.overlaystrandid].val:0;return d.endAngle=a.startAngle+e*b,l(d)};q.append("path").attr("d",function(a){return r(a)}).attr("fill","url(#d3utils-whitecarbon)").attr("fill-opacity","60%"),n.append("g").classed("lines",!0),n.append("g").classed("labels",!0),n.select(".lines").selectAll("polyline").data(p).enter().append("polyline").attr("stroke","black").style("fill","none").attr("stroke-width",1).attr("points",function(a){var b=l.centroid(a),c=m.centroid(a),d=m.centroid(a),e=a.startAngle+(a.endAngle-a.startAngle)/2;return d[0]=.95*k*(e<Math.PI?1:-1),[b,c,d]});var s=n.select(".labels").selectAll("text").data(p).enter().append("text").attr("transform",function(a){var b=m.centroid(a),c=a.startAngle+(a.endAngle-a.startAngle)/2;return b[0]=.99*k*(c<Math.PI?1:-1),"translate("+b+")"});s.append("tspan").text(function(a){return a.data.shortname+" - "+Math.round(100*a.data.val)+"%"}).attr("class","sn-label").style("text-anchor",function(a){var b=a.startAngle+(a.endAngle-a.startAngle)/2;return b<Math.PI?"start":"end"}),s.append("tspan").text(function(a){return a.data.fullname}).attr("class","fn-label").attr("dy","1em").attr("x","0").style("text-anchor",function(a){var b=a.startAngle+(a.endAngle-a.startAngle)/2;return b<Math.PI?"start":"end"})})},load_css:function(a){var c=document.createElement("link");c.type="text/css",c.rel="stylesheet",c.href=b.wwwroot+a,document.getElementsByTagName("head")[0].appendChild(c)},add_patterns_definitions:function(){var a=[{pattername:"d3utils-whitecarbon",imagedef:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHhtbG5zOnhsaW5rPSdodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rJyB3aWR0aD0nNicgaGVpZ2h0PSc2Jz4KICA8cmVjdCB3aWR0aD0nNicgaGVpZ2h0PSc2JyBmaWxsPScjZWVlZWVlJy8+CiAgPGcgaWQ9J2MnPgogICAgPHJlY3Qgd2lkdGg9JzMnIGhlaWdodD0nMycgZmlsbD0nI2U2ZTZlNicvPgogICAgPHJlY3QgeT0nMScgd2lkdGg9JzMnIGhlaWdodD0nMicgZmlsbD0nI2Q4ZDhkOCcvPgogIDwvZz4KICA8dXNlIHhsaW5rOmhyZWY9JyNjJyB4PSczJyB5PSczJy8+Cjwvc3ZnPg=="}],b=d.select("body").select("svg#d3progresspatternsdef");b.empty()&&d.select("body").append("svg").attr("id","d3utilspatternsdef").append("defs").selectAll("pattern").data(a).enter().append("pattern").attr("id",function(a){return a.pattername}).attr("patternUnits","userSpaceOnUse").attr("width",10).attr("height",10).append("image").attr("xlink:href",function(a){return a.imagedef}).attr("x",0).attr("y",0).attr("width",10).attr("height",10)}}});