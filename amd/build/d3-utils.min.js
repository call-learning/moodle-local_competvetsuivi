define(["jquery","core/config","local_competvetsuivi/config","d3","d3-bullet-cvs","d3-progress"],function(a,b,c,d,e,f){return{default_padding:{top:10,right:5,bottom:1,left:5},bullet_charts:function(b,c){this.load_css("/local/competvetsuivi/js/d3-libraries/bullet-cvs/d3-bullet-cvs.css");var f="#"+b,g=a(f).first(),h=Object.assign(c.padding||{},this.default_padding),i=g.parent().width()-h.left-h.right,j=g.parent().height()-h.top-h.bottom,k=e.bulletcvs().width(i).height(j).data(c);d.select(f).call(k)},progress_charts:function(b,c){this.load_css("/local/competvetsuivi/js/d3-libraries/progress/d3-progress.css");var e="#"+b,g=a(e).first(),h=function(){var a=g.parent().innerWidth(),b=g.height(),h=f.progress().width(a).height(b).data(c);d.select(e).call(h)};a(document).ready(h),a(window).bind("resize",function(){a(g).empty(),h()})},ring_charts:function(b,c){var e=this;e.add_patterns_definitions();var f="#"+b,g=a(f).first(),h=e.default_padding,i=function(){var a=g.parent().innerWidth(),b=g.parent().innerHeight(),e=Math.min(a,b)/3,i=parseInt(g.css("font-size")),j=d.arc().outerRadius(e-10).innerRadius(e/1.3),k=d.arc().outerRadius(1.2*e).innerRadius(1.2*e-i),l=d.arc().outerRadius(1.5*e).innerRadius(1.5*e-i),m=d.select(f).attr("width",a).attr("height",b).append("g").attr("transform","translate("+(a/2+h.left)+","+(b/2+h.top)+")"),n=d.pie().value(function(a){return a.val}).sort(null),o=n(Object.values(c.compsvalues)),p=m.selectAll(".arc").data(o).enter().append("g").attr("class","arc");p.append("path").attr("d",j).attr("class",function(a){return"macrocomp-"+a.data.colorindex+" arc-bg"});var q=function(a){var b=a.endAngle-a.startAngle,d=Object.assign({},a),e="undefined"!==a.data.strandvals[c.overlaystrandid]?a.data.strandvals[c.overlaystrandid].val:0;return d.endAngle=a.startAngle+e*b,j(d)};p.append("path").attr("d",function(a){return q(a)}).attr("fill","url(#d3utils-whitecarbon)").attr("fill-opacity","60%"),m.append("g").classed("lines",!0),m.append("g").classed("labels",!0);var r=Array.from(o).map(function(a,b){var c=b%2?k:l,d=c.centroid(a),f=a.startAngle+(a.endAngle-a.startAngle)/2,g=f<Math.PI?1:-1,h=b%4+1;return d[0]=e*h*g,d});m.select(".lines").selectAll("polyline").data(o).enter().append("polyline").attr("stroke","lightgray").style("fill","none").attr("stroke-width",1).attr("points",function(a,b){var c=b%2?k:l,d=j.centroid(a),e=c.centroid(a),f=r[b];return f[0]=.85*f[0],[d,e,f]});var s=m.select(".labels").selectAll("text").data(o).enter().append("text").attr("transform",function(a,b){var c=r[b];return c[0]=.99*c[0],"translate("+c+")"});s.append("tspan").text(function(a){return a.data.shortname+" - "+Math.round(100*a.data.val)+"%"}).attr("class","sn-label").style("text-anchor",function(a){var b=a.startAngle+(a.endAngle-a.startAngle)/2;return b<Math.PI?"start":"end"}),s.append("tspan").text(function(a){return a.data.fullname}).attr("class","fn-label").attr("dy","1em").attr("x","0").style("text-anchor",function(a){var b=a.startAngle+(a.endAngle-a.startAngle)/2;return b<Math.PI?"start":"end"})};a(document).ready(i),a(window).bind("resize",function(){a(g).empty(),i()})},load_css:function(a){var c=document.createElement("link");c.type="text/css",c.rel="stylesheet",c.href=b.wwwroot+a,document.getElementsByTagName("head")[0].appendChild(c)},add_patterns_definitions:function(){var a=[{pattername:"d3utils-whitecarbon",imagedef:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHhtbG5zOnhsaW5rPSdodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rJyB3aWR0aD0nNicgaGVpZ2h0PSc2Jz4KICA8cmVjdCB3aWR0aD0nNicgaGVpZ2h0PSc2JyBmaWxsPScjZWVlZWVlJy8+CiAgPGcgaWQ9J2MnPgogICAgPHJlY3Qgd2lkdGg9JzMnIGhlaWdodD0nMycgZmlsbD0nI2U2ZTZlNicvPgogICAgPHJlY3QgeT0nMScgd2lkdGg9JzMnIGhlaWdodD0nMicgZmlsbD0nI2Q4ZDhkOCcvPgogIDwvZz4KICA8dXNlIHhsaW5rOmhyZWY9JyNjJyB4PSczJyB5PSczJy8+Cjwvc3ZnPg=="}],b=d.select("body").select("svg#d3progresspatternsdef");b.empty()&&d.select("body").append("svg").attr("id","d3utilspatternsdef").append("defs").selectAll("pattern").data(a).enter().append("pattern").attr("id",function(a){return a.pattername}).attr("patternUnits","userSpaceOnUse").attr("width",10).attr("height",10).append("image").attr("xlink:href",function(a){return a.imagedef}).attr("x",0).attr("y",0).attr("width",10).attr("height",10)}}});