define(["jquery","core/config"],function(a,b){var c=require.config({paths:{"d3-progress":b.wwwroot+"/lib/javascript.php/"+b.jsrev+"/local/competvetsuivi/js/d3-libraries/progress/d3-progress"+(b.developerdebug?".min":""),d3:b.wwwroot+"/lib/javascript.php/"+b.jsrev+"/local/competvetsuivi/js/d3/d3"+(b.developerdebug?".min":"")},map:{"d3-progress":{"d3-axis":"d3","d3-scale":"d3","d3-format":"d3","d3-transition":"d3","d3-shape":"d3","d3-selection":"d3"}},shim:{"d3-progress":{deps:["d3","d3-axis","d3-scale","d3-format","d3-transition","d3-shape","d3-selection"]},d3:{exports:"d3"}}});return{default_padding:{top:10,right:5,bottom:1,left:5},default_progress_chart_height:125,default_doghnut_chart_height:300,progress_charts:function(b,d,e){this.load_css("/local/competvetsuivi/js/d3-libraries/progress/d3-progress.css"),c(["d3","d3-progress"],function(c,f){var g="#"+b,h=a(g).first(),i=this,j=function(){var a=h.parent().innerWidth(),b=i.default_progress_chart_height;e&&void 0!==e.size&&(void 0!==e.size.height&&0!=e.size.height&&(b=e.size.height?e.size.height:h.height()),void 0!==e.size.width&&0!=e.size.height&&(a=e.size.width?e.size.width:a));var j=f.progress().width(a).height(b).data(d);c.select(g).call(j)};a(document).ready(j),a(window).bind("resize",function(){a(h).empty(),j()})})},ring_charts:function(b,d,e){var f=this;this.load_css("/local/competvetsuivi/js/d3-libraries/progress/d3-progress.css"),c(["d3"],function(c){f.add_doghnut_patterns_definitions(c);var g="#"+b,h=a(g).first(),i=f.default_padding,j=function(){var a=h.parent().innerWidth(),b=h.parent().innerHeight();e&&(void 0!==e.size&&(void 0!==e.size.height&&0!=e.size.height&&(b=e.size.height?e.size.height:h.height()),void 0!==e.size.width&&0!=e.size.width&&(a=e.size.width?e.size.width:a)),void 0!==e.padding&&void 0!==e.padding.top&&void 0!==e.padding.left&&void 0!==e.padding.right&&void 0!==e.padding.bottom&&(i=e.padding));var f=Math.min(a-2*i.left,b-2*i.top)/2,j=2,k=c.arc().outerRadius(f-j).innerRadius(f/1.8),l=c.select(g).attr("width",a).attr("height",b).append("g").attr("transform","translate("+(a/2+i.left)+","+(b/2+i.top)+")"),m=c.pie().value(function(a){return a.val}).sort(null),n=m(Object.values(d.compsvalues)),o=l.selectAll(".arc").data(n).enter().append("g").attr("class","arc"),p=c.arc().outerRadius(f).innerRadius(f/1.8-j);o.append("path").attr("d",p).attr("class",function(){return"arc-bg-underlayer"}),o.append("path").attr("d",k).attr("class",function(a){return"macrocomp-"+a.data.colorindex+" arc-bg"}),o.append("text").attr("class","doghnut-text-percent").attr("x",function(a){return k.centroid(a)[0]}).attr("y",function(a){return k.centroid(a)[1]}).style("text-anchor","middle").text(function(a){var b=Math.round(100*a.value);return b<5?"":b+"%"});var q=[],r=.05,s=.1;o.selectAll("text.doghnut-text-percent").each(function(a){q[a.index]=this.getBBox(),q[a.index].position=a.position}),o.data(q).append("rect").attr("class","doghnut-text-percent-bg").attr("x",function(a){return a.x-a.width*r/2}).attr("y",function(a){return a.y-a.height*s/2}).attr("width",function(a){return a.width*(1+r/2)}).attr("height",function(a){return a.height*(1+s/2)}),o.selectAll("text.doghnut-text-percent").raise()};a(document).ready(j),a(window).bind("resize",function(){a(h).empty(),j()})})},load_css:function(c){var d=b.wwwroot+c;if(0===a("link[href='"+d+"']").length){var e=document.createElement("link");e.type="text/css",e.rel="stylesheet",e.href=d,document.getElementsByTagName("head")[0].appendChild(e)}},add_doghnut_patterns_definitions:function(a){var b=[{pattername:"doghnut-p1",imagedef:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHhtbG5zOnhsaW5rPSdodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rJyB3aWR0aD0nNicgaGVpZ2h0PSc2Jz4KICA8cmVjdCB3aWR0aD0nNicgaGVpZ2h0PSc2JyBmaWxsPScjZWVlZWVlJy8+CiAgPGcgaWQ9J2MnPgogICAgPHJlY3Qgd2lkdGg9JzMnIGhlaWdodD0nMycgZmlsbD0nI2U2ZTZlNicvPgogICAgPHJlY3QgeT0nMScgd2lkdGg9JzMnIGhlaWdodD0nMicgZmlsbD0nI2Q4ZDhkOCcvPgogIDwvZz4KICA8dXNlIHhsaW5rOmhyZWY9JyNjJyB4PSczJyB5PSczJy8+Cjwvc3ZnPg=="}],c=a.select("body").select("svg#d3progresspatternsdef");c.empty()&&a.select("body").append("svg").attr("id","d3utilspatternsdef").append("defs").selectAll("pattern").data(b).enter().append("pattern").attr("id",function(a){return a.pattername}).attr("patternUnits","userSpaceOnUse").attr("width",10).attr("height",10).append("image").attr("xlink:href",function(a){return a.imagedef}).attr("x",0).attr("y",0).attr("width",10).attr("height",10)}}});