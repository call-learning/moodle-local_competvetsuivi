{"version":3,"file":"d3-progress.js","sources":["../src/progress.js"],"sourcesContent":["import { select as d3Select } from 'd3-selection';\nimport { axisBottom as d3AxisBottom } from 'd3-axis';\nimport { scaleLinear as d3ScaleLinear } from 'd3-scale';\nimport { symbol as d3Symbol, symbolTriangle as d3SymbolTriangle } from 'd3-shape';\n\n/**\n * Make a data structure to hold a progress bar with markers\n * @return {progressChart}\n */\nexport default function () {\n  let data = {};\n  let width = 960;\n  let height = 100;\n  let graphMargins = { top: 20, right: 5, bottom: 30, left: 15 }; // Absolute margins\n  let graphWidth = function () { return width - graphMargins.left - graphMargins.right; };\n  let graphHeight = function () { return height - graphMargins.top - graphMargins.bottom; };\n  let marginW = 0.05;\n  let marginH = 0.1;\n\n  let ticksValues = [0, 0.25, 0.50, 0.75, 1];\n\n  // For each small multipleâ€¦\n  function progressCVS (svgitem) {\n\n    // Prepare for patterns\n    progressCVS.addPatternDefinition();\n    progressCVS.addFilterDefinition(2, 2, 2, 'linear', 0.5);\n\n    // This wrapper contains the graph and the axis\n    let wrap = svgitem\n      .attr('width', width)\n      .attr('height', height)\n      .append('g')\n      .attr('class', 'progress-cvs')\n      .attr('transform', `translate(${graphMargins.left},0)`);\n\n    // Then for each bar/results, we need to loop through and get the progress bar\n    // This is just the graph without axis\n    let extentX = graphWidth() * (1 - marginW * 2);\n    let extentY = graphHeight() * (1 - marginH * 2);\n    let graphWrap = wrap\n      .append('g')\n      .attr('width', extentX)\n      .attr('height', extentY)\n      .attr('transform', `translate(0,${graphMargins.top})`);\n\n    // Scales\n    const scaleX = d3ScaleLinear()\n      .domain([0, 1])\n      .range([0, extentX]);\n\n    // Draw grey background\n    graphWrap.append('rect')\n      .attr('class', 'background-bar')\n      .attr('width', extentX)\n      .attr('height', extentY)\n      .attr('rx', extentY * marginH)\n      .attr('ry', extentY * marginH)\n      .attr('x', 0)\n      .attr('y', 0);\n\n    const tickFormat = function (val) {return Math.round(val * 100);};\n    const tickSize = graphMargins.bottom / 3;\n\n    // Add the bottom axes\n    const axisgraph = wrap.append('g').attr('class', 'axisgraph');\n    axisgraph.attr('transform', `translate(0,${extentY + graphMargins.top})`).call(\n      d3AxisBottom(scaleX)\n        .tickValues(ticksValues)\n        .tickFormat(tickFormat)\n        .tickSize(tickSize)\n    );\n    // Fixup style\n    axisgraph.select('.domain').remove();\n    axisgraph.attr('font-size', tickSize); // 80% of the margin\n\n    // Now the bars\n\n    // Draw results\n    data.forEach(function (currentData, index) {\n      let wrapper = graphWrap.append('g')\n        .attr('width', extentX)\n        .attr('height', extentY / data.length)\n        .attr('rx', extentY * marginH)\n        .attr('ry', extentY * marginH)\n        .attr('class', 'comptype-' + currentData.result.type)\n        .attr('transform', `translate(0,${index * (extentY / data.length)})`);\n\n      let maxHeight = extentY / data.length;\n      progressCVS.barCVS(currentData, wrapper, maxHeight, scaleX, extentX, extentY);\n\n      // Now the marker bars\n      if ('stopbars' in currentData) {\n        wrapper.selectAll('g.labelbar')\n          .data(currentData.stopbars)\n          .enter()\n          .append('rect')\n          .attr('class', 'barlabelbar')\n          .attr('width', graphWidth() * marginW / 10)\n          .attr('height', function () {return progressCVS.barHeight(maxHeight);})\n          .attr('x', function (r) { return scaleX(r); })\n          .attr('y', function () { return progressCVS.barMiddlePosition(maxHeight);});\n      }\n    });\n    let resultsmarkervalues =\n      data.map(function (r, index) {\n        let labelData = {};\n        labelData.value = r.result.value;\n        labelData.position = 1 - index % 2;\n        return labelData;\n      });\n\n    progressCVS.displayLabels(resultsmarkervalues, 'labelmarker', tickSize, wrap, extentY, scaleX, 'rect');\n\n    // Add stop bar labels\n    let labelbarvalues =\n      data.reduce(function (acc, currentData, dataIndex) {\n        let labelData = {};\n        if ('stopbars' in currentData) {\n          currentData.stopbars.forEach(function (val) {\n            labelData.value = val;\n            labelData.position = 1 - dataIndex % 2;\n            acc.push(labelData);\n          });\n        }\n        return acc;\n      }, []);\n    progressCVS.displayLabels(labelbarvalues, 'labelbar', tickSize, wrap, extentY, scaleX, 'ellipse');\n  }\n\n  progressCVS.barCVS = function (currentData, wrapper, maxHeight, scaleX, extentX) {\n    progressCVS.createBar(\n      wrapper,\n      'bar-gray-bg',\n      maxHeight,\n      function () {return extentX;}\n    );\n\n    progressCVS.createBar(\n      wrapper,\n      'bar-bg',\n      maxHeight,\n      function () {return scaleX(currentData.result.value);}\n    );\n\n    progressCVS.createBar(\n      wrapper,\n      'bar',\n      maxHeight,\n      function () {return scaleX(currentData.result.value);}\n    );\n\n    // Draw markers\n    let circleRadius = progressCVS.barHeight(maxHeight) / 2.2;\n\n    let marker = wrapper.selectAll('g.marker')\n      .data(currentData.markers)\n      .enter()\n      .append('g')\n      .attr('class', function (d) {return d.active ? 'marker active' : 'marker';})\n      .attr('x', function (r) { return scaleX(r.value);})\n      .attr('y', maxHeight / 2);\n\n    marker.append('circle')\n      .attr('r', circleRadius)\n      .attr('cx', function (r) { return scaleX(r.value);})\n      .attr('cy', maxHeight / 2);\n\n    marker.append('text')\n      .attr('x', function (r) { return scaleX(r.value);})\n      .attr('y', maxHeight / 2)\n      .text(function (d) {return d.label;})\n      .attr('class', 'marker-text')\n      .attr('font-size', maxHeight / 2);\n  };\n\n  progressCVS.createBar = function (item, classname, maxHeight, widthCallBack) {\n    item.append('rect')\n      .attr('class', classname)\n      .attr('width', widthCallBack)\n      .attr('height', function () {return progressCVS.barHeight(maxHeight);})\n      .attr('rx', maxHeight * marginH * 2)\n      .attr('ry', maxHeight * marginH * 2)\n      .attr('x', 0)\n      .attr('y', function () { return progressCVS.barMiddlePosition(maxHeight);});\n  };\n\n  // labelmarker: a set of value + position (0 = top, 1 = bottom)\n  progressCVS.displayLabels = function (resultsmarkervalues, labelmarkerclass, tickSize, wrap, extentY, scaleX, shape) {\n\n    var triangleSize = Math.sqrt(graphWidth() / 25);\n    var topPosition = function (index) {\n      return index ? graphMargins.top - triangleSize : graphMargins.top + extentY + triangleSize;\n    };\n\n    const resultsmarker = wrap\n      .selectAll('g.' + labelmarkerclass)\n      .data(resultsmarkervalues)\n      .enter()\n      .append('g')\n      .attr('class', labelmarkerclass)\n      .attr('transform', function (r) {return `translate(${scaleX(r.value)},${topPosition(r.position)})`;});\n\n    var symbolGenerator = d3Symbol().size(triangleSize * triangleSize).type(d3SymbolTriangle);\n\n    //var resultsmarker = resultsmarkerouter.append('g');\n    resultsmarker\n      .append('path')\n      .attr('class', 'value-arrow')\n      .attr('d', function () {\n        return symbolGenerator();\n      })\n      .attr('transform', function (r) {\n        return `rotate(${180 * r.position}),translate(0,${\n          (r.position ? -triangleSize : - triangleSize*0.5)})`;\n      });\n\n    resultsmarker.append('g')\n      .attr('class', labelmarkerclass + '-container')\n      .attr('transform', function (r) { return `translate(0,${r.position ? 0 : triangleSize * 2})`;})\n      .append('text')\n      .attr('class', labelmarkerclass + '-text')\n      .attr('font-size', tickSize * 1.2)\n      .text(function (r) {return `${Math.round(r.value * 100)} %`;});\n\n    // Adjust rect so they are in the background\n    // Margin of few px\n    var markersbb = [];\n    wrap.selectAll('text.' + labelmarkerclass + '-text').each(function (d, i) {\n      markersbb[i] = this.getBBox(); // get bounding box of text field and store it in texts array\n    });\n\n    if (shape == 'ellipse') {\n      wrap\n        .selectAll('g.' + labelmarkerclass + '-container')\n        .data(markersbb)\n        .append('ellipse')\n        .lower()\n        .attr('class', labelmarkerclass + '-bg')\n        .attr('cx', function (d) { return d.x + d.width / 2; })\n        .attr('cy', function (d) { return d.y + d.height / 2; })\n        .attr('rx', function (d) { return d.width * (1 + marginW * 4) / 2; })\n        .attr('ry', function (d) { return d.height * (1 + marginH * 4) / 2; });\n      ;\n    } else {\n      wrap\n        .selectAll('g.' + labelmarkerclass + '-container')\n        .data(markersbb)\n        .append('rect')\n        .lower()\n        .attr('class', labelmarkerclass + '-bg')\n        .attr('x', function (d) { return d.x - d.width * marginW / 2; })\n        .attr('y', function (d) { return d.y - d.height * marginH / 2; })\n        .attr('width', function (d) { return d.width * (1 + marginW / 2); })\n        .attr('height', function (d) { return d.height * (1 + marginH / 2); });\n    }\n  };\n\n  progressCVS.barHeight = function (maxHeight) { return maxHeight * (1 - marginH * 2); };\n  progressCVS.barMiddlePosition = function (maxHeight) { return maxHeight / 2 - progressCVS.barHeight(maxHeight) / 2; };\n\n  progressCVS.width = function (_) {\n    if (!arguments.length) return width;\n    width = +_;\n    return this;\n  };\n\n  progressCVS.height = function (_) {\n    if (!arguments.length) return height;\n    height = +_;\n    return this;\n  };\n\n  progressCVS.margins = function (_) {\n    if (!arguments.length) return graphMargins;\n    graphMargins = _;\n    return this;\n  };\n\n  progressCVS.data = function (_) {\n    if (!arguments.length) return data;\n    data = _;\n    return this;\n  };\n\n  progressCVS.addPatternDefinition = function (_) {\n    // See https://iros.github.io/patternfills/sample_d3.html\n    var availablepatterns = [\n      {\n        pattername: 'crosshatch',\n        imagedef: 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc4JyBoZWlnaHQ9JzgnPgogIDxyZWN0IHdpZHRoPSc4JyBoZWlnaHQ9JzgnIGZpbGw9JyNmZmYnLz4KICA8cGF0aCBkPSdNMCAwTDggOFpNOCAwTDAgOFonIHN0cm9rZS13aWR0aD0nMC41JyBzdHJva2U9JyNhYWEnLz4KPC9zdmc+Cg=='\n      },\n      {\n        pattername: 'diagonal-stripe-3',\n        imagedef: 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScxMCcgaGVpZ2h0PScxMCc+CiAgPHJlY3Qgd2lkdGg9JzEwJyBoZWlnaHQ9JzEwJyBmaWxsPSd3aGl0ZScvPgogIDxwYXRoIGQ9J00tMSwxIGwyLC0yCiAgICAgICAgICAgTTAsMTAgbDEwLC0xMAogICAgICAgICAgIE05LDExIGwyLC0yJyBzdHJva2U9J2JsYWNrJyBzdHJva2Utd2lkdGg9JzMnLz4KPC9zdmc+'\n      },\n      {\n        pattername: 'whitecarbon',\n        imagedef: 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHhtbG5zOnhsaW5rPSdodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rJyB3aWR0aD0nNicgaGVpZ2h0PSc2Jz4KICA8cmVjdCB3aWR0aD0nNicgaGVpZ2h0PSc2JyBmaWxsPScjZWVlZWVlJy8+CiAgPGcgaWQ9J2MnPgogICAgPHJlY3Qgd2lkdGg9JzMnIGhlaWdodD0nMycgZmlsbD0nI2U2ZTZlNicvPgogICAgPHJlY3QgeT0nMScgd2lkdGg9JzMnIGhlaWdodD0nMicgZmlsbD0nI2Q4ZDhkOCcvPgogIDwvZz4KICA8dXNlIHhsaW5rOmhyZWY9JyNjJyB4PSczJyB5PSczJy8+Cjwvc3ZnPg=='\n      },\n      {\n        pattername: 'dots-7',\n        imagedef: 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScxMCcgaGVpZ2h0PScxMCc+CiAgPHJlY3Qgd2lkdGg9JzEwJyBoZWlnaHQ9JzEwJyBmaWxsPSd3aGl0ZScgLz4KICA8cmVjdCB4PScwJyB5PScwJyB3aWR0aD0nNycgaGVpZ2h0PSc3JyBmaWxsPSdibGFjaycgLz4KPC9zdmc+'\n      },\n    ];\n\n    var svgpattern = d3Select('body').select('svg#d3progresspatternsdef');\n    if (svgpattern.empty()) {\n      d3Select('body')\n        .append('svg')\n        .attr('id', 'd3progresspatternsdef')\n        .append('defs')\n        .selectAll('pattern')\n        .data(availablepatterns)\n        .enter()\n        .append('pattern')\n        .attr('id', function (d) {return d.pattername;})\n        .attr('patternUnits', 'userSpaceOnUse')\n        .attr('width', 10)\n        .attr('height', 10)\n        .append('image')\n        .attr('xlink:href', function (d) {return d.imagedef;})\n        .attr('x', 0)\n        .attr('y', 0)\n        .attr('width', 10)\n        .attr('height', 10);\n    }\n  };\n\n  progressCVS.addFilterDefinition = function (dx, dy, stdDeviation, type, slope) {\n    var svgpattern = d3Select('body').select('svg#d3progressfiltersdef');\n    if (svgpattern.empty()) {\n      var defs = d3Select('body')\n        .append('svg')\n        .attr('id', 'd3progressfiltersdef')\n        .append('defs');\n      var filter = defs.append('filter')\n        .attr('id', 'd3std-dropshadow');\n      filter.append('feGaussianBlur')\n        .attr('in', 'SourceAlpha')\n        .attr('stdDeviation', parseInt(stdDeviation));\n\n      filter.append('feOffset')\n        .attr('dx', dx)\n        .attr('dy', dy);\n      var feComponentTransfer = filter.append('feComponentTransfer');\n      feComponentTransfer.append('feFuncA')\n        .attr('type', type)\n        .attr('slope', parseFloat(slope));\n\n      var feMerge = filter.append('feMerge');\n      feMerge.append('feMergeNode');\n      feMerge.append('feMergeNode').attr('in', 'SourceGraphic');\n    }\n  };\n\n  return progressCVS;\n}\n\n\n"],"names":["d3ScaleLinear","d3AxisBottom","d3Symbol","d3SymbolTriangle","d3Select"],"mappings":"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"}